import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
df_2000s = pd.read_csv("2000-2009.csv", encoding='latin1')
df_2010s = pd.read_csv("2010-2019.csv", encoding='latin1')
df = pd.concat([df_2000s, df_2010s], ignore_index=True)
df.head()
print("This is the first set")
print(df_2000s.shape)
print("This is the second set")
print(df_2010s.shape)
df.info()
df.describe(include='all')
df.shape
df.isnull().sum()
useless_cols=['AsOfDate','Program','BankNCUANumber','FranchiseCode',
             'FranchiseName', 'BusinessAge', 'InitialInterestRate', 'ChargeOffDate']
df.drop(columns=[col for col in useless_cols if col in df.columns], inplace=True) #I added this so we can keep rerunning this cell without errors

df = df.copy() # i Added this as a checkpoint 
df['NaicsDescription']   = df['NaicsDescription'].fillna('Unknown')
df['BankFDICNumber']     = df['BankFDICNumber'].fillna(0)
df['FirstDisbursementDate'] = df['FirstDisbursementDate'].fillna('Unknown')
df['BusinessType']       = df['BusinessType'].fillna(df['BusinessType'].mode()[0])
status_map = {'PIF': 1, 'CHGOFF': 0}
df['LoanStatus'] = df['LoanStatus'].map(status_map)


# Histograms for useful numeric variables
histcols =  ['GrossApproval', 'SBAGuaranteedApproval', 'ApprovalFiscalYear', 'TermInMonths', 'LoanStatus', 'GrossChargeOffAmount', 'RevolverStatus', 'JobsSupported']
plt.figure(figsize=(14, 10))
for i, col in enumerate(histcols, 1):
    plt.subplot(3, 3, i)
    sns.histplot(df[col], bins=30, kde=True, color='skyblue')
    plt.title(col)
    plt.xlabel('')
    plt.ylabel('Count')

plt.tight_layout()
plt.ticklabel_format(style='plain', axis='both')
plt.show()


# Heatmap Correlation Matrix
numeric_df = df.select_dtypes(include='number')
numeric_df = numeric_df.drop(columns=['BankFDICNumber', 'BorrZip', 'ApprovalFiscalYear', 'NaicsCode', 'CongressionalDistrict'])
fig, ax1 = plt.subplots(figsize=(11, 11))
sns.heatmap(numeric_df.corr(), annot=True, ax=ax1)
